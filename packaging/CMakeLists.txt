# Value populated by CMAKE_PROJECT_NAME
# set(CPACK_PACKAGE_NAME MyProj)

# Value populated by CMAKE_PROJECT_DESCRIPTION
# set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "Example project")

# Base package settings
set(CPACK_PACKAGE_VENDOR "My Company")
set(CPACK_PACKAGE_DIRECTORY build/distribution)
set(CPACK_PACKAGE_INSTALL_DIRECTORY ${CPACK_PACKAGE_NAME})
set(CPACK_SOURCE_PACKAGE_FILE_NAME "${CMAKE_PROJECT_NAME}-${CMAKE_PROJECT_VERSION}")
set(CPACK_PACKAGE_VERSION_MAJOR ${CMAKE_PROJECT_VERSION_MAJOR})
set(CPACK_PACKAGE_VERSION_MINOR ${CMAKE_PROJECT_VERSION_MINOR})
set(CPACK_PACKAGE_VERSION_PATCH ${CMAKE_PROJECT_VERSION_PATCH})
set(CPACK_VERBATIM_VARIABLES YES)

# Package resources
set(CPACK_PACKAGE_DESCRIPTION_FILE ${CMAKE_CURRENT_LIST_DIR}/Description.txt)
set(CPACK_RESOURCE_FILE_WELCOME ${CMAKE_CURRENT_LIST_DIR}/Welcome.txt)
set(CPACK_RESOURCE_FILE_LICENSE ${CMAKE_CURRENT_LIST_DIR}/License.txt)
set(CPACK_RESOURCE_FILE_README ${CMAKE_CURRENT_LIST_DIR}/Readme.txt)

# This option will change the mount drive icon used.
# set(CPACK_PACKAGE_ICON ${CMAKE_CURRENT_LIST_DIR}/dmg/volume.icns)

# macOS settings for DragNDrop generator
set(CPACK_DMG_SLA_USE_RESOURCE_FILE_LICENSE OFF)
set(CPACK_DMG_BACKGROUND_IMAGE "${CMAKE_CURRENT_LIST_DIR}/dmg/AppDMGBackground.tiff")
set(CPACK_DMG_DS_STORE_SETUP_SCRIPT "${CMAKE_CURRENT_LIST_DIR}/dmg/AppDMGSetup.scpt")
set(CPACK_DMG_VOLUME_NAME "${CMAKE_PROJECT_NAME}")

# Windows settings for NSIS generator
set(CPACK_NSIS_DISPLAY_NAME "My Company products")
set(CPACK_NSIS_PACKAGE_NAME "My App")
set(CPACK_NSIS_MANIFEST_DPI_AWARE true)
set(CPACK_NSIS_ENABLE_UNINSTALL_BEFORE_INSTALL YES)
set(CPACK_NSIS_MUI_ICON ${PROJECT_SOURCE_DIR}/src/assets/icons/icon.ico)
set(CPACK_NSIS_INSTALLED_ICON_NAME ${PROJECT_SOURCE_DIR}/src/assets/icons/icon.ico)
set(CPACK_NSIS_MUI_UNIICON ${PROJECT_SOURCE_DIR}/src/assets/icons/uninstall_icon.ico)
set(CPACK_NSIS_MUI_HEADERIMAGE ${PROJECT_SOURCE_DIR}/src\\\\assets\\\\icons\\\\nsis_header.bmp)
set(CPACK_NSIS_MUI_WELCOMEFINISHPAGE_BITMAP ${PROJECT_SOURCE_DIR}/src\\\\assets\\\\icons\\\\nsis_install_welcome.bmp)
set(CPACK_NSIS_MUI_UNWELCOMEFINISHPAGE_BITMAP ${PROJECT_SOURCE_DIR}/src\\\\assets\\\\icons\\\\nsis_uninstall_welcome.bmp)

# Install and uninstall start menu entries on Windows
set(CPACK_NSIS_CREATE_ICONS_EXTRA
  "CreateShortCut '$SMPROGRAMS\\\\$STARTMENU_FOLDER\\\\${PROJECT_NAME}.lnk' '$INSTDIR\\\\bin\\\\App.exe'")
set(CPACK_NSIS_DELETE_ICONS_EXTRA
  "Delete '$SMPROGRAMS\\\\$START_MENU\\\\${PROJECT_NAME}.lnk'")

if (NOT WIN32)
  set(CMAKE_INSTALL_PREFIX "/opt/mycompany.com/${PROJECT_NAME}")
endif ()

# Generator selection per platform
if (WIN32)
  set(CPACK_GENERATOR ZIP NSIS)
elseif (APPLE)
  set(CPACK_GENERATOR TGZ DragNDrop)
elseif (CMAKE_SYSTEM_NAME STREQUAL "Linux")
  set(CPACK_GENERATOR TGZ RPM)
else ()
  set(CPACK_GENERATOR TGZ)
endif ()

include(CPack)
